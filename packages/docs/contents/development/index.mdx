---
title: æœ¬åœ°å¼€å‘æŒ‡å—
description: Afilmoryæœ¬åœ°å¼€å‘æŒ‡å—
createdAt: 2025-09-17T21:26:08+08:00
lastModified: 2025-09-18T00:22:55+08:00
---

# æœ¬åœ°å¼€å‘æŒ‡å—

> æœ¬åœ°å¼€å‘æš‚ä¸æ”¯æŒWindowsç³»ç»Ÿ, è‹¥ä½ ä½¿ç”¨Windowsç³»ç»Ÿï¼Œå¯å‚è€ƒ[å¦‚ä½•ä½¿ç”¨ WSL åœ¨ Windows ä¸Šå®‰è£… Linux](https://learn.microsoft.com/zh-cn/windows/wsl/install)ï¼Œå¹¶å¯ç»“åˆTREA IDE[ ä½¿ç”¨ WSL å¼€å‘](https://docs.trae.cn/ide/wsl)

## ğŸŒ è·å–æºç 

### ä¸‹è½½æºç 

```bash
# GitHub åœ°å€
git clone https://github.com/tangmantan/afilmory.git

# Gitee åœ°å€
git clone https://gitee.com/tanmantang/afilmory.git
```

### å®‰è£…ä¾èµ–

```bash
cd afilmory
pnpm install
```

## ğŸ„ ç¯å¢ƒé…ç½®

### é…ç½®config.jsonæ–‡ä»¶

ä½ éœ€è¦å¤åˆ¶config.example.jsonæ¨¡æ¿ä¸ºconfig.jsonï¼Œå¹¶ä¿®æ”¹ä¿¡æ¯

```json
{
  "name": "æ‡’æ´‹æ´‹å–å’–å•¡",  //è®¾ç½®ç½‘ç«™åç§°
  "title": "æ‡’æ´‹æ´‹å–å’–å•¡", //è®¾ç½®ç½‘ç«™title
  "model": "light",  // è®¾ç½®æ¨¡å¼ï¼Œå¯é€‰ light | dark
  "description": "è®°å½•ç”Ÿæ´»ä¸­çš„ç¾å¥½ç¬é—´ï¼Œé€šè¿‡æˆ‘çš„é•œå¤´è®°å½•æ¯æ—¥çš„æ¸©æš–å’Œæƒ…æ„Ÿã€‚",  // è®¾ç½®æè¿°
  "url": "https://pix.tanmantang.com",  // è®¾ç½®ç½‘ç«™urlï¼Œå¯ç”¨äºåˆ†äº«ç­‰æ—¶å€™çš„é“¾æ¥åœ°å€
  // è®¾ç½®ä½œè€…ä¿¡æ¯
  "author": {
    "name": "è°­æ»¡å ‚",
    "url": "https://tanmantang.com/",
    "avatar": "https://tanmantang.oss-cn-chengdu.aliyuncs.com/public/logo.png"
  },
  // è®¾ç½®åœ°å›¾
  "map": [
    "maplibre"
  ],
  // è®¾ç½®åœ°å›¾æ ·å¼
  "mapStyle": "https://tiles.openfreemap.org/styles/liberty",
  // è®¾ç½®ç¤¾äº¤åª’ä½“ï¼Œä¸è®¾ç½®åˆ™ä¸æ˜¾ç¤ºï¼Œå¯é€‰ github | gitee | douyin | twitter | rss ,
  "social": {
    "github": "tangmantan/afilmory",
    "gitee": "tanmantang/afilmory",
    "douyin": "https://www.douyin.com/user/username",
    "rss": true
  },
  // å­˜å‚¨æ¡¶è®¾ç½®, è¯¦æƒ…è¯·æŸ¥çœ‹å­˜å‚¨æä¾›å•†
  "storage": {
    "provider": "s3",
    "bucket": "tanmantang",
    "region": "oss-cn-chengdu",
    "prefix": "afilmory/",
    "endpoint": "https://oss-cn-chengdu.aliyuncs.com"
  },
  // å¦‚æœä½ ä½¿ç”¨githubä½œä¸ºä½ çš„å›¾ç‰‡å­˜å‚¨ä»“åº“ï¼Œåˆ™éœ€è¦é…ç½®ä»¥ä¸‹ä¿¡æ¯ï¼Œå¹¶ä¸”éœ€è¦åœ¨.envé…ç½®æ–‡ä»¶ä¸­æ·»åŠ GIT_TOKEN
  "repo": {
    "enable": false, // ä¿®æ”¹ä¸º true
    "url": "https://github.com/username/gallery-assets"  // ä½ githubå›¾ç‰‡ä»“åº“åœ°å€
  }
}
```

### é…ç½®.envé…ç½®æ–‡ä»¶
å¤åˆ¶ .env.template ä¸º .env æ–‡ä»¶

```bash
S3_ACCESS_KEY_ID='å¡«å†™ä½ çš„å­˜å‚¨æ¡¶ID'
S3_SECRET_ACCESS_KEY='å¡«å†™ä½ çš„å­˜å‚¨æ¡¶SECRET'

PG_CONNECTION_STRING='å¡«å†™ä½ çš„æ•°æ®åº“è¿æ¥åœ°å€'

GIT_TOKEN='è‹¥æœªå¯ç”¨githubå›¾ç‰‡ä»“åº“åˆ™æ— éœ€å¡«å†™'
```

## ğŸ“‹ CLI å‘½ä»¤

### å¼€å‘å‘½ä»¤

```bash
# å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼ˆåŒæ—¶è¿è¡Œwebå’ŒSSRï¼‰
pnpm dev

# ä»…å¯åŠ¨webå¼€å‘æœåŠ¡å™¨
pnpm --filter web dev

# ä»…å¯åŠ¨SSRå¼€å‘æœåŠ¡å™¨
pnpm --filter @afilmory/ssr dev

# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
pnpm build

# ä»å­˜å‚¨æ„å»ºæ¸…å•ï¼ˆç”Ÿæˆç…§ç‰‡å…ƒæ•°æ®ï¼‰
pnpm run build:manifest

# å¼ºåˆ¶é‡æ–°æ„å»ºæ‰€æœ‰ç…§ç‰‡å’Œå…ƒæ•°æ®
pnpm run build:manifest -- --force

# ä»…å¼ºåˆ¶é‡æ–°ç”Ÿæˆç¼©ç•¥å›¾
pnpm run build:manifest -- --force-thumbnails

# ä»…å¼ºåˆ¶é‡æ–°ç”Ÿæˆæ¸…å•
pnpm run build:manifest -- --force-manifest
```


### æ•°æ®åº“å‘½ä»¤ï¼ˆSSRåº”ç”¨ï¼‰

```bash
# ç”Ÿæˆæ•°æ®åº“è¿ç§»
pnpm --filter @afilmory/ssr db:generate

# è¿è¡Œæ•°æ®åº“è¿ç§»
pnpm --filter @afilmory/ssr db:migrate
```
### ä»£ç è´¨é‡å‘½ä»¤

```bash
# æ£€æŸ¥å¹¶ä¿®å¤ä»£ç 
pnpm lint

# æ ¼å¼åŒ–ä»£ç 
pnpm format

# ç±»å‹æ£€æŸ¥ï¼ˆwebåº”ç”¨ï¼‰
pnpm --filter web type-check
```

## ğŸ”§ é«˜çº§ç”¨æ³•

### è‡ªå®šä¹‰å­˜å‚¨æä¾›ç¨‹åº

å®ç°æ¥å£ä»¥æ”¯æŒæ–°çš„å­˜å‚¨åç«¯ï¼š`StorageProvider`

```tsx
import { StorageProvider } from './src/core/storage/interfaces'

class MyStorageProvider implements StorageProvider {
  async getFile(key: string): Promise<Buffer | null> {
    // Implement file retrieval logic
  }

  async listImages(): Promise<StorageObject[]> {
    // Implement image list retrieval logic
  }

  // ... other methods
}
```

### è‡ªå®šä¹‰å›¾åƒå¤„ç†

åœ¨ç›®å½•ä¸­æ·»åŠ è‡ªå®šä¹‰å¤„ç†å™¨ï¼š`src/core/image/`

```tsx
export async function customImageProcessor(buffer: Buffer) {
  // Custom image processing logic
  return processedBuffer
}
```

